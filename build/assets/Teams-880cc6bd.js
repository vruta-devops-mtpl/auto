import{r,j as e,aC as R,aD as z,B as x,aE as V,aG as W,a3 as G,aq as J,ar as y,as as Q,aH as U,ax as u}from"./index-cd518a67.js";import{u as X}from"./useThemeClass-a68676b2.js";import{D as Y}from"./SvgIcon-36bfcfad.js";import{u as Z,S as ee,C as ae}from"./search-5380743c.js";import"./Views-bb2b2b8f.js";import{c as se,a as te,F as ne,d as re,e as le}from"./index.esm-ae318cd2.js";const he=()=>{const{textTheme:v}=X(),{fetchTeamList:S,createTeamApi:w,fetchTeamDetails:D,updateTeamApi:F,loader:O,detailsLoader:E,teamList:g,teamDetails:l,setTeamDetails:i,deleteTeamApi:I,isDeleting:p}=Z(),N=se().shape({name:te().required("Team name is required").trim()}),[j,k]=r.useState(1),[C,_]=r.useState(10),[A,T]=r.useState(!1),[P,o]=r.useState(!1),[c,m]=r.useState(""),[f,q]=r.useState(""),$=r.useMemo(()=>[{header:"Team",accessorKey:"name",enableSorting:!1,cell:a=>{var s,n;return e.jsx("div",{children:((n=(s=a==null?void 0:a.row)==null?void 0:s.original)==null?void 0:n.name)??"-"})}},{header:"Team Members",accessorKey:"",cell:a=>{var s,n,t,b;return e.jsx("div",{children:(n=(s=a==null?void 0:a.row)==null?void 0:s.original)!=null&&n.user_count?`${(b=(t=a==null?void 0:a.row)==null?void 0:t.original)==null?void 0:b.user_count} Members`:"-"})},enableSorting:!1},{header:"Actions",accessorKey:"",cell:a=>e.jsxs("div",{className:"flex text-lg",children:[e.jsx("span",{className:`cursor-pointer p-2 hover:${v}`,onClick:()=>{m(a.row.original.id),D(a.row.original.id),o(!0)},children:e.jsx(R,{})}),e.jsx("span",{className:"cursor-pointer p-2 hover:text-red-500",onClick:()=>{m(a.row.original.id),T(!0)},children:e.jsx(z,{})})]})}],[]),B=a=>{k(a)},H=(a=0)=>{_(Number(a))},K=()=>{M(c)},d=()=>{m(""),T(!1)},h=async()=>{const a=`?search=${f}`;S(a)},L=async(a,s)=>{s(!0);const n={workspace_id:U.VITE_WORK_SPACE_ID,name:a.name,is_active:!0,type:"team"},t=c===""?await w(n):await F(n,c);s(!1),(t==null?void 0:t.status)==="success"?(h(),o(!1),t!=null&&t.message&&u(t.message),i(null)):t!=null&&t.message&&u(t.message,"danger")},M=async a=>{const s=await I(a);(s==null?void 0:s.status)==="success"?(h(),d(),s!=null&&s.message&&u(s.message)):s!=null&&s.message&&u(s.message,"danger")};return r.useEffect(()=>{h()},[C,j,f]),e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between items-center bg-danger w-full mb-5 ,t-3",children:[e.jsx(ee,{onInputChange:a=>{q(a)}}),e.jsx("div",{className:"flex",children:e.jsx(x,{onClick:()=>{m(""),o(!0)},block:!0,variant:"solid",size:"sm",icon:e.jsx(V,{}),children:"Create Team"})})]}),e.jsx(Y,{columns:$,data:g,loading:O,onPaginationChange:B,onSelectChange:H,module:"Team",pagingData:{total:g.length,pageIndex:j,pageSize:C}}),e.jsx(ae,{isOpen:A,type:"danger",title:"Delete Team",confirmButtonColor:"red-600",onClose:d,onRequestClose:d,onCancel:d,onConfirm:K,confirmText:p?"Please Wait":"Confirm",disabled:p,children:e.jsx("p",{children:"Are you sure you want to delete this team? All record related to this team will be deleted as well. This action cannot be undone."})}),e.jsx("div",{children:e.jsxs(W,{className:"p-0",isOpen:P,shouldCloseOnOverlayClick:!1,shouldCloseOnEsc:!1,onClose:()=>{o(!1),i(null)},onRequestClose:()=>{o(!1),i(null)},children:[e.jsxs("h5",{className:"mb-4",children:[c===""?"Create":"Edit"," Team"]}),E?e.jsx(e.Fragment,{children:e.jsx(G,{loading:!0,type:"cover"})}):e.jsx(e.Fragment,{children:e.jsx("div",{children:e.jsx(ne,{initialValues:{name:(l==null?void 0:l.name)??"",user_count:(l==null?void 0:l.user_count)??0},validationSchema:N,onSubmit:(a,{setSubmitting:s,setFieldError:n})=>{L(a,s)},children:({touched:a,errors:s,resetForm:n,isSubmitting:t})=>e.jsx(re,{children:e.jsxs(J,{children:[e.jsx(y,{label:"Team",invalid:s.name&&a.name,asterisk:!0,errorMessage:s.name,children:e.jsx(le,{type:"text",autoComplete:"off",name:"name",placeholder:"Type here...",component:Q})}),e.jsxs(y,{className:"text-right mb-0",children:[e.jsx(x,{type:"reset",className:"ltr:mr-3 rtl:ml-3",onClick:()=>{o(!1),i(null)},children:"Cancel"}),e.jsx(x,{loading:t,variant:"solid",type:"submit",children:t?"Please Wait":"Submit"})]})]})})})})})]})})]})};export{he as default};
