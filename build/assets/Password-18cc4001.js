import{n as $,y as b,u as F,j as s,ap as A,aq as M,ar as w,B as _,ax as h}from"./index-cd518a67.js";import"./SvgIcon-36bfcfad.js";import"./Views-bb2b2b8f.js";import{P as p}from"./PasswordInput-61dc54bf.js";import{c as u,a as d,f as g,F as q,d as E,e as c}from"./index.esm-ae318cd2.js";import{u as T}from"./useTimeOutMessage-2e54961d.js";import"./useThemeClass-a68676b2.js";const B=({screen:i,sessionId:f,email:x})=>{const{t:e}=$(),[m,l]=T(),{changePassword:y,updateNewPassword:j}=b(),{email:S}=F(o=>o.auth.user),P=u().shape({current_password:d().required(e("change_password.current_password.isNotEmpty").toString()).trim(),new_password:d().required(e("change_password.new_password.isNotEmpty").toString()).trim().min(8,e("change_password.new_password.isShort").toString()).matches(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/,e("change_password.new_password.isPassword").toString()),confirm_new_password:d().oneOf([g("new_password"),""],e("change_password.confirm_password.isNotMatch").toString()).required(e("change_password.confirm_password.isNotEmpty").toString()).trim()}),N=u().shape({new_password:d().required(e("change_password.new_password.isNotEmpty").toString()).trim().min(8,e("change_password.new_password.isShort").toString()).matches(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/,e("change_password.new_password.isPassword").toString()),confirm_new_password:d().oneOf([g("new_password"),""],e("change_password.confirm_password.isNotMatch").toString()).required(e("change_password.confirm_password.isNotEmpty").toString()).trim()}),C=async(o,r,t)=>{if(i==="change-password"){const n={...o,email:S||""},a=await y(n);console.log(a),(a==null?void 0:a.status)==="failed"&&l(a.message),(a==null?void 0:a.status)==="success"&&(h("Password updated"),t())}else{const n={email:x||"",password:o.confirm_new_password||"",session:f||""},a=await j(n);(a==null?void 0:a.status)==="failed"&&l(a.message),(a==null?void 0:a.status)==="success"&&(h("Password updated"),t())}r(!1)};return s.jsxs(s.Fragment,{children:[m&&s.jsx(A,{showIcon:!0,className:"mb-4",type:"danger",children:s.jsx(s.Fragment,{children:m})}),s.jsx(q,{initialValues:{current_password:"",new_password:"",confirm_new_password:""},validationSchema:i=="change-password"?P:N,onSubmit:(o,{setSubmitting:r,resetForm:t})=>{r(!0),setTimeout(()=>{C(o,r,t)},1e3)},children:({touched:o,errors:r,isSubmitting:t,resetForm:n})=>s.jsx(E,{children:s.jsxs(M,{children:[i==="change-password"&&s.jsx(w,{label:"Current Password",asterisk:!0,invalid:r.current_password&&o.current_password,errorMessage:r.current_password,children:s.jsx(c,{type:"password",autoComplete:"off",name:"current_password",placeholder:"Type here...",component:p})}),s.jsx(w,{label:"New Password",asterisk:!0,invalid:r.new_password&&o.new_password,errorMessage:r.new_password,children:s.jsx(c,{type:"password",autoComplete:"off",name:"new_password",placeholder:"Type here...",component:p})}),s.jsx(w,{label:"Confirm Password",asterisk:!0,invalid:r.confirm_new_password&&o.confirm_new_password,errorMessage:r.confirm_new_password,children:s.jsx(c,{type:"password",autoComplete:"off",name:"confirm_new_password",placeholder:"Type here...",component:p})}),s.jsxs("div",{className:"mt-4",children:[s.jsx(_,{variant:"solid",loading:t,type:"submit",className:"ltr:mr-2 rtl:ml-2",children:t?"Updating":"Update"}),s.jsx(_,{type:"button",onClick:()=>n(),children:"Cancel"})]})]})})})]})};export{B as default};
