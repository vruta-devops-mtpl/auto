import{n as R,r as w,an as k,W as A,ax as E,j as s,ap as I,aq as M,ar as i,as as x,B as T,ay as O,aw as _}from"./index-cd518a67.js";import{A as q}from"./ActionLink-4f2343f2.js";import{P as j}from"./PasswordInput-61dc54bf.js";import{u as B}from"./useTimeOutMessage-2e54961d.js";import{c as L,a as m,f as V,F as W,d as z,e as d}from"./index.esm-ae318cd2.js";import"./useThemeClass-a68676b2.js";const D=g=>{var f;const{t}=R(),b=L().shape({password:m().required(`${t("password.isNotEmpty")}`).min(8,t("password.isShort").toString()).matches(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/,t("password.isPassword").toString()).max(50,t("password.isMax").toString()),otp:m().required(t("otp.isNotEmpty").toString()).trim().matches(/^\d+$/,t("otp.isOtp").toString()),confirmPassword:m().oneOf([V("password")],t("confirm_password.isNotMatch").toString())}),{disableSubmit:y=!1,className:P,signInUrl:S="/sign-in"}=g,[c,N]=w.useState(!1),[p,$]=B(),v=k(),o=A(),C=async(a,e)=>{var r,h,u;e(!0);try{const n={confirm_password:a.confirmPassword,password:a.password,email:((r=o==null?void 0:o.state)==null?void 0:r.email)??"",otp:a.otp};(await O(n)).status===201&&(e(!1),N(!0))}catch(n){const l=((u=(h=n==null?void 0:n.response)==null?void 0:h.data)==null?void 0:u.status)||500,F=l!==_?`${t(`auth.reset_password.${l}`)}`:"Something Went Wrong";$(F),e(!1)}};return w.useEffect(()=>{c&&(E("Your password has been successfully reset"),setTimeout(()=>{v("/sign-in")},100))},[c]),s.jsxs("div",{className:P,children:[s.jsx("div",{className:"mb-6",children:c?s.jsxs(s.Fragment,{children:[s.jsx("h3",{className:"mb-1",children:"Reset done"}),s.jsx("p",{children:"Your password has been successfully reset"})]}):s.jsxs(s.Fragment,{children:[s.jsx("h3",{className:"mb-1",children:"Reset password"}),s.jsx("p",{children:"Please enter a verification code received in the mail and set a new password"})]})}),p&&s.jsx(I,{showIcon:!0,className:"mb-4",type:"danger",children:p}),s.jsx(W,{initialValues:{password:"",confirmPassword:"",email:((f=o==null?void 0:o.state)==null?void 0:f.email)??"",otp:""},validationSchema:b,onSubmit:(a,{setSubmitting:e})=>{y?e(!1):C(a,e)},children:({touched:a,errors:e,isSubmitting:r})=>s.jsx(z,{children:s.jsxs(M,{children:[s.jsxs(s.Fragment,{children:[s.jsx(i,{label:"Email",children:s.jsx(d,{type:"text",autoComplete:"off",name:"email",disabled:!0,placeholder:"",component:x})}),s.jsx(i,{asterisk:!0,label:"Verification Code",invalid:e.otp&&a.otp,errorMessage:e.otp,children:s.jsx(d,{type:"text",autoComplete:"off",name:"otp",placeholder:"Type here...",component:x})}),s.jsx(i,{asterisk:!0,label:"Password",invalid:e.password&&a.password,errorMessage:e.password,children:s.jsx(d,{type:"text",autoComplete:"off",name:"password",placeholder:"Type here...",component:j})}),s.jsx(i,{label:"Confirm Password",asterisk:!0,invalid:e.confirmPassword&&a.confirmPassword,errorMessage:e.confirmPassword,children:s.jsx(d,{type:"text",autoComplete:"off",name:"confirmPassword",placeholder:"Type here...",component:j})}),s.jsx(T,{block:!0,loading:r,variant:"solid",type:"submit",children:r?"Submiting...":"Submit"})]}),s.jsxs("div",{className:"mt-4 text-center",children:[s.jsx("span",{children:"Back to "}),s.jsx(q,{to:S,children:"Sign in"})]})]})})})]})},Y=()=>s.jsx(D,{disableSubmit:!1}),Q=Y;export{Q as default};
