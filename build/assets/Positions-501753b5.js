import{r,j as a,aC as Y,aD as Z,B as j,aE as V,aG as ee,a3 as ae,aq as se,ar as h,as as te,aF as y,ax as u}from"./index-cd518a67.js";import{u as ie}from"./useThemeClass-a68676b2.js";import{D as ne}from"./SvgIcon-36bfcfad.js";import{u as oe,S as re,C as le}from"./search-5380743c.js";import"./Views-bb2b2b8f.js";import{c as ce,a as w,F as me,d as de,e as pe}from"./index.esm-ae318cd2.js";import{u as ge}from"./usePosition-226cea48.js";const fe=()=>{const{textTheme:T}=ie(),{fetchTeamList:N,teamList:O}=oe(),{fetchPositionList:k,createPositionApi:F,fetchPositionDetails:E,updatePositionApi:I,loader:q,detailsLoader:A,positionList:_,positionDetails:t,positionDropDown:L,fetchPositionDropDown:K,setPositionDetails:c,deletePositionApi:M,isDeleting:C}=ge(),R=ce().shape({name:w().required("Position title is required").trim(),team:w().required("Team is required").trim()}),[b,B]=r.useState(1),[f,D]=r.useState(10);r.useState(!1);const[$,v]=r.useState(!1),[z,l]=r.useState(!1),[m,d]=r.useState(""),[P,H]=r.useState(""),W=r.useMemo(()=>[{header:"Position Title",accessorKey:"name",enableSorting:!1,cell:e=>{var s,i;return a.jsx("div",{children:((i=(s=e==null?void 0:e.row)==null?void 0:s.original)==null?void 0:i.name)??"-"})}},{header:"Reporting Position",accessorKey:"reporting_position_name",enableSorting:!1,cell:e=>{var s,i;return a.jsx("div",{children:((i=(s=e==null?void 0:e.row)==null?void 0:s.original)==null?void 0:i.reporting_position_name)??"-"})}},{header:"Team",accessorKey:"team_name",enableSorting:!1,cell:e=>{var s,i;return a.jsx("div",{children:((i=(s=e==null?void 0:e.row)==null?void 0:s.original)==null?void 0:i.team_name)??"-"})}},{header:"Team Members",accessorKey:"team_members",enableSorting:!1,cell:e=>{var s,i;return a.jsx("div",{children:((i=(s=e==null?void 0:e.row)==null?void 0:s.original)==null?void 0:i.team_members)??"-"})}},{header:"Actions",accessorKey:"",cell:e=>a.jsxs("div",{className:"flex text-lg",children:[a.jsx("span",{className:`cursor-pointer p-2 hover:${T}`,onClick:()=>{d(e.row.original.id),E(e.row.original.id),l(!0)},children:a.jsx(Y,{})}),a.jsx("span",{className:"cursor-pointer p-2 hover:text-red-500",onClick:()=>{d(e.row.original.id),v(!0)},children:a.jsx(Z,{})})]})}],[]),G=e=>{B(e)},J=(e=0)=>{D(Number(e))},Q=()=>{X(m)},p=()=>{d(""),v(!1)},x=async()=>{const e=`?search=${P}`;k(e)},U=async(e,s)=>{s(!0),console.log(e);const i={name:e.name,is_active:!0,reporting_position_id:e.reporting_position_id,team_id:e.team},n=m===""?await F(i):await I(i,m);s(!1),(n==null?void 0:n.status)==="success"?(x(),l(!1),n!=null&&n.message&&u(n.message),c(null)):n!=null&&n.message&&u(n.message,"danger")},X=async e=>{const s=await M(e);(s==null?void 0:s.status)==="success"?(x(),p(),s!=null&&s.message&&u(s.message)):s!=null&&s.message&&u(s.message,"danger")};return r.useEffect(()=>{N(""),K()},[]),r.useEffect(()=>{x()},[f,b,P]),a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex justify-between items-center bg-danger w-full mb-5 ,t-3",children:[a.jsx(re,{onInputChange:e=>{H(e)}}),a.jsx("div",{className:"flex",children:a.jsx(j,{onClick:()=>{d(""),l(!0)},block:!0,variant:"solid",size:"sm",icon:a.jsx(V,{}),children:"Create Position"})})]}),a.jsx(ne,{columns:W,data:_,onPaginationChange:G,onSelectChange:J,module:"Position",loading:q,pagingData:{total:_.length,pageIndex:b,pageSize:f}}),a.jsx(le,{isOpen:$,type:"danger",title:"Delete Position",confirmButtonColor:"red-600",onClose:p,onRequestClose:p,onCancel:p,onConfirm:Q,confirmText:C?"Please Wait":"Confirm",disabled:C,children:a.jsx("p",{children:"Are you sure you want to delete this position? All record related to this position will be deleted as well. This action cannot be undone."})}),a.jsx("div",{children:a.jsxs(ee,{className:"p-0",isOpen:z,shouldCloseOnOverlayClick:!1,shouldCloseOnEsc:!1,onClose:()=>{l(!1),c(null)},onRequestClose:()=>{l(!1),c(null)},children:[a.jsxs("h5",{className:"mb-4",children:[m===""?"Create":"Edit"," Position"]}),A?a.jsx(a.Fragment,{children:a.jsx(ae,{loading:!0,type:"cover"})}):a.jsx(a.Fragment,{children:a.jsx("div",{children:a.jsx(me,{initialValues:{name:(t==null?void 0:t.name)??"",reporting_position_id:"",team:(t==null?void 0:t.team_id)??"",position:t!=null&&t.reporting_position_name?{label:t==null?void 0:t.reporting_position_name,value:t==null?void 0:t.reporting_position_id}:"",teamSelect:t!=null&&t.team_id?{label:t==null?void 0:t.team_name,value:t==null?void 0:t.team_id}:""},validationSchema:R,onSubmit:(e,{setSubmitting:s,setFieldError:i})=>{U(e,s)},children:({touched:e,errors:s,resetForm:i,isSubmitting:n,setFieldValue:g,values:S})=>a.jsx(de,{children:a.jsxs(se,{children:[a.jsx(h,{label:"Position Title",invalid:s.name&&e.name,asterisk:!0,errorMessage:s.name,children:a.jsx(pe,{type:"text",autoComplete:"off",name:"name",placeholder:"Type here...",component:te})}),a.jsx(h,{label:"Reporting Position",invalid:s.reporting_position_id&&e.reporting_position_id,errorMessage:s.reporting_position_id,children:a.jsx(y,{placeholder:"Select if any",options:L.map(o=>({label:o.position_name,value:o.position_id})),value:S.position,onChange:o=>{g("reporting_position_id",o.value),g("position",o)}})}),a.jsx(h,{label:"Team",invalid:s.team&&e.team,asterisk:!0,errorMessage:s.team,children:a.jsx(y,{placeholder:"Select or type to create new",options:O.map(o=>({label:o.name,value:o.id})),value:S.teamSelect,onChange:o=>{g("team",o.value),g("teamSelect",o)}})}),a.jsxs(h,{className:"text-right mb-0",children:[a.jsx(j,{type:"reset",className:"ltr:mr-3 rtl:ml-3",onClick:()=>{l(!1),c(null)},children:"Cancel"}),a.jsx(j,{loading:n,variant:"solid",type:"submit",children:n?"Please Wait":"Submit"})]})]})})})})})]})})]})};export{fe as default};
